<!DOCTYPE html>
<html lang="en">
<head>
    <title>xeogl Example</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">

    <link href="css/styles.css" rel="stylesheet"/>

    <script src="../build/xeogl.js"></script>

    <script src="js/models/glTFModel.js"></script>
    <script src="libs/gl-matrix-min.js"></script>
    <script src="js/zspace/zSpaceEffect_complete.js"></script>
    <script src="js/zspace/zSpaceStylusControl.js"></script>

<body>

<div id="info">
    <h1><a
            href="../docs/classes/GLTFModel.html"
            target="_parent">GLTFModel</a> viewed with a <a
            href="../docs/classes/ZSpaceEffect.html"
            target="_parent">ZSpaceEffect</a></h1>

    <pre id="log">model:  Reciprocating Saw - [<a href='models/gltf/ReciprocatingSaw/README.md'
                                                  target="_parent">model info</a>]</pre>

</div>


<script>

    //----------------------------------------------------------------------------
    // Load a glTF Reciprocating Saw model into the default Scene
    //----------------------------------------------------------------------------

    var model = new xeogl.GLTFModel({
        src: "models/gltf/ReciprocatingSaw/glTF/ReciprocatingSaw.gltf",
        transform: new xeogl.Rotate({
            xyz: [1, 0, 0],
            angle: 90
        })
    });

    // Flatten modelling transform hierarchies

    model.on("loaded", function () {
        for (var entityId in model.entities) {
            if (model.entities.hasOwnProperty(entityId)) {
                var entity = model.entities[entityId];
                if (entity.transform && entity.transform.parent) {
                    model.add(entity.transform = new xeogl.Transform({
                        matrix: entity.transform.leafMatrix
                    }));
                }
            }
        }
    });

    //----------------------------------------------------------------------------
    // Allow camera control with keyboard and mouse
    //----------------------------------------------------------------------------

    var cameraControl = new xeogl.CameraControl();

    //---------------------------------------------------
    // Create a zSpace effect and stylus control
    //---------------------------------------------------

    var zspaceEffect = new xeogl.ZSpaceEffect({
        canvasOffset: [330, 0]
    });

    zspaceEffect.on("supported", function (supported) {
        if (supported) {
            new xeogl.ZSpaceStylusControl();
        } else {
            document.getElementById("log").innerText = "(zSpace not detected) ";

            // Viewpoint for non-zSpace viewing
            var camera = model.scene.camera;
            camera.eye = [-110.8940200805664, -44.85665512084961, 276.6570739746094];
            camera.look = [-110.8940200805664, -44.85665512084961, -0.46092796325683594];
            camera.up = [0, 1, 0];
        }
    });

</script>
</body>
</html>