<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>src/animation/cameraFlightAnimation.js - xeogl</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link href='https://fonts.googleapis.com/css?family=Exo+2:400,800,900,700,600,500|Roboto:100,300,400,500,700,900'  rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">

                <h1 class="projectTitle"><a href="../../">xeogl</a> / <a href="../../docs">API Docs</a></h1>

        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.7.0</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/AABBGeometry.html">AABBGeometry</a></li>
                                <li><a href="../classes/AABBHelper.html">AABBHelper</a></li>
                                <li><a href="../classes/AmbientLight.html">AmbientLight</a></li>
                                <li><a href="../classes/Annotation.html">Annotation</a></li>
                                <li><a href="../classes/AnnotationStory.html">AnnotationStory</a></li>
                                <li><a href="../classes/AxisHelper.html">AxisHelper</a></li>
                                <li><a href="../classes/BoxGeometry.html">BoxGeometry</a></li>
                                <li><a href="../classes/BuildableModel.html">BuildableModel</a></li>
                                <li><a href="../classes/Camera.html">Camera</a></li>
                                <li><a href="../classes/CameraControl.html">CameraControl</a></li>
                                <li><a href="../classes/CameraFlightAnimation.html">CameraFlightAnimation</a></li>
                                <li><a href="../classes/CameraFollowAnimation.html">CameraFollowAnimation</a></li>
                                <li><a href="../classes/CameraPath.html">CameraPath</a></li>
                                <li><a href="../classes/CameraPathAnimation.html">CameraPathAnimation</a></li>
                                <li><a href="../classes/Canvas.html">Canvas</a></li>
                                <li><a href="../classes/Clip.html">Clip</a></li>
                                <li><a href="../classes/ClipHelper.html">ClipHelper</a></li>
                                <li><a href="../classes/Clips.html">Clips</a></li>
                                <li><a href="../classes/Component.html">Component</a></li>
                                <li><a href="../classes/CubeTexture.html">CubeTexture</a></li>
                                <li><a href="../classes/CubicBezierCurve.html">CubicBezierCurve</a></li>
                                <li><a href="../classes/Curve.html">Curve</a></li>
                                <li><a href="../classes/CylinderGeometry.html">CylinderGeometry</a></li>
                                <li><a href="../classes/DirLight.html">DirLight</a></li>
                                <li><a href="../classes/EmphasisMaterial.html">EmphasisMaterial</a></li>
                                <li><a href="../classes/Entity.html">Entity</a></li>
                                <li><a href="../classes/Fresnel.html">Fresnel</a></li>
                                <li><a href="../classes/Frustum.html">Frustum</a></li>
                                <li><a href="../classes/Geometry.html">Geometry</a></li>
                                <li><a href="../classes/GeometryBuilder.html">GeometryBuilder</a></li>
                                <li><a href="../classes/GLTFModel.html">GLTFModel</a></li>
                                <li><a href="../classes/HeightmapGeometry.html">HeightmapGeometry</a></li>
                                <li><a href="../classes/Input.html">Input</a></li>
                                <li><a href="../classes/LabelHelper.html">LabelHelper</a></li>
                                <li><a href="../classes/LambertMaterial.html">LambertMaterial</a></li>
                                <li><a href="../classes/Lights.html">Lights</a></li>
                                <li><a href="../classes/LoadingEffect.html">LoadingEffect</a></li>
                                <li><a href="../classes/Lookat.html">Lookat</a></li>
                                <li><a href="../classes/Material.html">Material</a></li>
                                <li><a href="../classes/MetallicMaterial.html">MetallicMaterial</a></li>
                                <li><a href="../classes/Model.html">Model</a></li>
                                <li><a href="../classes/Nintendo3DSGeometry.html">Nintendo3DSGeometry</a></li>
                                <li><a href="../classes/OBBGeometry.html">OBBGeometry</a></li>
                                <li><a href="../classes/OBBHelper.html">OBBHelper</a></li>
                                <li><a href="../classes/OBJGeometry.html">OBJGeometry</a></li>
                                <li><a href="../classes/OBJModel.html">OBJModel</a></li>
                                <li><a href="../classes/Ortho.html">Ortho</a></li>
                                <li><a href="../classes/OutlineMaterial.html">OutlineMaterial</a></li>
                                <li><a href="../classes/Path.html">Path</a></li>
                                <li><a href="../classes/PathGeometry.html">PathGeometry</a></li>
                                <li><a href="../classes/Perspective.html">Perspective</a></li>
                                <li><a href="../classes/PhongMaterial.html">PhongMaterial</a></li>
                                <li><a href="../classes/Pin.html">Pin</a></li>
                                <li><a href="../classes/PlaneGeometry.html">PlaneGeometry</a></li>
                                <li><a href="../classes/PlaneHelper.html">PlaneHelper</a></li>
                                <li><a href="../classes/PointLight.html">PointLight</a></li>
                                <li><a href="../classes/QuadraticBezierCurve.html">QuadraticBezierCurve</a></li>
                                <li><a href="../classes/Quaternion.html">Quaternion</a></li>
                                <li><a href="../classes/Rotate.html">Rotate</a></li>
                                <li><a href="../classes/Scale.html">Scale</a></li>
                                <li><a href="../classes/Scene.html">Scene</a></li>
                                <li><a href="../classes/SceneJSModel.html">SceneJSModel</a></li>
                                <li><a href="../classes/Shadow.html">Shadow</a></li>
                                <li><a href="../classes/Skybox.html">Skybox</a></li>
                                <li><a href="../classes/SpecularMaterial.html">SpecularMaterial</a></li>
                                <li><a href="../classes/SphereGeometry.html">SphereGeometry</a></li>
                                <li><a href="../classes/Spinner.html">Spinner</a></li>
                                <li><a href="../classes/SplineCurve.html">SplineCurve</a></li>
                                <li><a href="../classes/SplineCurveHelper.html">SplineCurveHelper</a></li>
                                <li><a href="../classes/SpotLight.html">SpotLight</a></li>
                                <li><a href="../classes/StereoEffect.html">StereoEffect</a></li>
                                <li><a href="../classes/STLModel.html">STLModel</a></li>
                                <li><a href="../classes/Story.html">Story</a></li>
                                <li><a href="../classes/TeapotGeometry.html">TeapotGeometry</a></li>
                                <li><a href="../classes/TestModel.html">TestModel</a></li>
                                <li><a href="../classes/Texture.html">Texture</a></li>
                                <li><a href="../classes/TorusGeometry.html">TorusGeometry</a></li>
                                <li><a href="../classes/Transform.html">Transform</a></li>
                                <li><a href="../classes/Translate.html">Translate</a></li>
                                <li><a href="../classes/VectorTextGeometry.html">VectorTextGeometry</a></li>
                                <li><a href="../classes/Viewport.html">Viewport</a></li>
                                <li><a href="../classes/xeogl.html">xeogl</a></li>
                                <li><a href="../classes/xeogl.math.math.html">xeogl.math.math</a></li>
                            </ul>
                
                            <ul id="api-modules" class="apis modules">
                                <li><a href="..//modules/animation.html">animation</a></li>
                                <li><a href="..//modules/annotations.html">annotations</a></li>
                                <li><a href="..//modules/camera.html">camera</a></li>
                                <li><a href="..//modules/canvas.html">canvas</a></li>
                                <li><a href="..//modules/clipping.html">clipping</a></li>
                                <li><a href="..//modules/controls.html">controls</a></li>
                                <li><a href="..//modules/curves.html">curves</a></li>
                                <li><a href="..//modules/effects.html">effects</a></li>
                                <li><a href="..//modules/entities.html">entities</a></li>
                                <li><a href="..//modules/generation.html">generation</a></li>
                                <li><a href="..//modules/geometry.html">geometry</a></li>
                                <li><a href="..//modules/helpers.html">helpers</a></li>
                                <li><a href="..//modules/input.html">input</a></li>
                                <li><a href="..//modules/lighting.html">lighting</a></li>
                                <li><a href="..//modules/materials.html">materials</a></li>
                                <li><a href="..//modules/math.html">math</a></li>
                                <li><a href="..//modules/models.html">models</a></li>
                                <li><a href="..//modules/rendering.html">rendering</a></li>
                                <li><a href="..//modules/skyboxes.html">skyboxes</a></li>
                                <li><a href="..//modules/stories.html">stories</a></li>
                                <li><a href="..//modules/transforms.html">transforms</a></li>
                                <li><a href="..//modules/xeogl.html">xeogl</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <!--<div id="api-options">-->
                    <!--Show:-->
                    <!--<label for="api-show-inherited">-->
                        <!--<input type="checkbox" id="api-show-inherited" checked>-->
                        <!--Inherited-->
                    <!--</label>-->
            
                    <!--<label for="api-show-protected">-->
                        <!--<input type="checkbox" id="api-show-protected">-->
                        <!--Protected-->
                    <!--</label>-->
            
                    <!--<label for="api-show-private">-->
                        <!--<input type="checkbox" id="api-show-private">-->
                        <!--Private-->
                    <!--</label>-->
                    <!--<label for="api-show-deprecated">-->
                        <!--<input type="checkbox" id="api-show-deprecated">-->
                        <!--Deprecated-->
                    <!--</label>-->
            
                <!--</div>-->
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: src/animation/cameraFlightAnimation.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/**
 A **CameraFlightAnimation** jumps or flies the {{#crossLink &quot;Scene&quot;}}Scene&#x27;s{{/crossLink}} {{#crossLink &quot;Camera&quot;}}{{/crossLink}} to look at a given target.

 &lt;a href=&quot;../../examples/#animation_camera_flight&quot;&gt;&lt;img src=&quot;http://i.giphy.com/3o7TKP0jN800EQ99EQ.gif&quot;&gt;&lt;/img&gt;&lt;/a&gt;

 * TODO: Document behaviour for ortho projection
 * TODO: Update docs for camera refactor, where ortho and perspective components will always be present on camera

 ## Overview

 * Can be made to either fly or jump to its target.
 * While busy flying to a target, it can be stopped, or redirected to fly to a different target.

 A CameraFlightAnimation&#x27;s target can be:

 * specific &#x60;&#x60;&#x60;&#x60;eye&#x60;&#x60;&#x60;&#x60;, &#x60;&#x60;&#x60;&#x60;look&#x60;&#x60;&#x60;&#x60; and &#x60;&#x60;&#x60;&#x60;up&#x60;&#x60;&#x60;&#x60; positions,
 * an axis-aligned World-space bounding box (AABB), or
 * an instance or ID of any {{#crossLink &quot;Component&quot;}}{{/crossLink}} subtype that provides a World-space AABB.

 You can configure its {{#crossLink &quot;CameraFlightAnimation/fit:property&quot;}}{{/crossLink}}
 and {{#crossLink &quot;CameraFlightAnimation/fitFOV:property&quot;}}{{/crossLink}} properties to make it stop at the point where the target
 occupies a certain amount of the field-of-view.

 ## Examples

 * [Flying to random Entities](../../examples/#animation_camera_flight)

 ## Flying to an Entity

 Flying to an {{#crossLink &quot;Entity&quot;}}{{/crossLink}}:

 &#x60;&#x60;&#x60;&#x60;Javascript
 // Create a CameraFlightAnimation that takes one second to fly
 // the default Scene&#x27;s Camera to each specified target
 var cameraFlight = new xeogl.CameraFlightAnimation({
    fit: true, // Default
    fitFOV: 45, // Default, degrees
    duration: 1 // Default, seconds
 }, function() {
           // Arrived
       });

 // Create a Entity, which gets all the default components
 var entity = new Entity();

 // Fly to the Entity&#x27;s World-space AABB
 cameraFlight.flyTo(entity);
 &#x60;&#x60;&#x60;&#x60;
 ## Flying to a position

 Flying the CameraFlightAnimation from the previous example to specified eye, look and up positions:

 &#x60;&#x60;&#x60;&#x60;Javascript
 cameraFlight.flyTo({
    eye: [-5,-5,-5],
    look: [0,0,0]
    up: [0,1,0],
    duration: 1 // Default, seconds
 }, function() {
          // Arrived
      });
 &#x60;&#x60;&#x60;&#x60;

 ## Flying to an AABB

 Flying the CameraFlightAnimation from the previous two examples explicitly to the {{#crossLink &quot;Boundary3D&quot;}}Boundary3D&#x27;s{{/crossLink}}
 axis-aligned bounding box:

 &#x60;&#x60;&#x60;&#x60;Javascript
 cameraFlight.flyTo(entity.aabb);
 &#x60;&#x60;&#x60;&#x60;

 @class CameraFlightAnimation
 @module xeogl
 @submodule animation
 @constructor
 @param [scene] {Scene} Parent {{#crossLink &quot;Scene&quot;}}Scene{{/crossLink}}.
 @param [cfg.id] {String} Optional ID, unique among all components in the parent {{#crossLink &quot;Scene&quot;}}Scene{{/crossLink}}, generated automatically when omitted.
 @param [cfg.meta] {String:Object} Optional map of user-defined metadata to attach to this CameraFlightAnimation.
 @param [cfg.fit=true] {Boolean} When true, will ensure that when this CameraFlightAnimation has flown or jumped to a boundary
 it will adjust the distance between the {{#crossLink &quot;Camera&quot;}}{{/crossLink}}&#x27;s {{#crossLink &quot;Lookat/eye:property&quot;}}eye{{/crossLink}}
 and {{#crossLink &quot;Lookat/look:property&quot;}}{{/crossLink}} position so as to ensure that the target boundary is filling the view volume.
 @param [cfg.fitFOV=45] {Number} How much field-of-view, in degrees, that a target boundary should
 fill the canvas when fitting the {{#crossLink &quot;Camera&quot;}}Camera{{/crossLink}} to the target boundary. Only applies when the {{#crossLink &quot;Camera&quot;}}Camera{{/crossLink}}&#x27;s active projection is a{{#crossLink &quot;Perspective&quot;}}{{/crossLink}}.
 @param [cfg.trail] {Boolean} When true, will cause this CameraFlightAnimation to point the {{#crossLink &quot;Camera&quot;}}{{/crossLink}} in the direction that it is travelling.
 @param [cfg.duration=1] {Number} Flight duration, in seconds, when calling {{#crossLink &quot;CameraFlightAnimation/flyTo:method&quot;}}{{/crossLink}}.
 @extends Component
 */
(function () {

    &quot;use strict&quot;;

    var math = xeogl.math;

    xeogl.CameraFlightAnimation = xeogl.Component.extend({

        /**
         JavaScript class name for this Component.

         @property type
         @type String
         @final
         */
        type: &quot;xeogl.CameraFlightAnimation&quot;,

        _init: function (cfg) {

            // Shows a wireframe box for target AABBs
            this._aabbHelper = this.create({
                type: &quot;xeogl.Entity&quot;,
                geometry: this.create({
                    type: &quot;xeogl.AABBGeometry&quot;
                }),
                material: this.create({
                    type: &quot;xeogl.PhongMaterial&quot;,
                    diffuse: [0, 0, 0],
                    ambient: [0, 0, 0],
                    specular: [0, 0, 0],
                    emissive: [0.5, 1.0, 0.5],
                    lineWidth: 2
                }),
                visible: false,
                collidable: false
            });

            // Shows a wireframe box for target AABBs
            this._obbHelper = this.create({
                type: &quot;xeogl.Entity&quot;,
                geometry: this.create({
                    type: &quot;xeogl.OBBGeometry&quot;,
                    material: this.create({
                        type: &quot;xeogl.PhongMaterial&quot;,
                        diffuse: [0, 0, 0],
                        ambient: [0, 0, 0],
                        specular: [0, 0, 0],
                        emissive: [0.5, 1.0, 0.5],
                        lineWidth: 2
                    })
                }),
                visible: false,
                collidable: false // Effectively has no boundary
            });

            this._look1 = math.vec3();
            this._eye1 = math.vec3();
            this._up1 = math.vec3();

            this._look2 = math.vec3();
            this._eye2 = math.vec3();
            this._up2 = math.vec3();

            this._orthoScale1 = 1;
            this._orthoScale2 = 1;

            this._flying = false;
            this._flyEyeLookUp = false;
            this._flyingEye = false;
            this._flyingLook = false;
            this._flyingUp = false;

            this._callback = null;
            this._callbackScope = null;

            this._onTick = null;

            this._time1 = null;
            this._time2 = null;

            this.easing = cfg.easing !== false;

            this.duration = cfg.duration;
            this.fit = cfg.fit;
            this.fitFOV = cfg.fitFOV;
            this.trail = cfg.trail;
        },

        /**
         * Begins flying the {{#crossLink &quot;Camera&quot;}}{{/crossLink}}&#x27;s {{#crossLink &quot;Camera&quot;}}{{/crossLink}} to the given target.
         *
         *  * When the target is a boundary, the {{#crossLink &quot;Camera&quot;}}{{/crossLink}} will fly towards the target
         *    and stop when the target fills most of the canvas.
         *  * When the target is an explicit {{#crossLink &quot;Camera&quot;}}{{/crossLink}} position, given as &#x60;&#x60;&#x60;&#x60;eye&#x60;&#x60;&#x60;&#x60;, &#x60;&#x60;&#x60;&#x60;look&#x60;&#x60;&#x60;&#x60; and &#x60;&#x60;&#x60;&#x60;up&#x60;&#x60;&#x60;&#x60;
         *    vectors, then this CameraFlightAnimation will interpolate the {{#crossLink &quot;Camera&quot;}}{{/crossLink}} to that target and stop there.
         * @method flyTo
         * @param [params=scene]  {*|Component} Either a parameters object or a {{#crossLink &quot;Component&quot;}}{{/crossLink}} subtype that has an AABB.
         * @param[params.arc=0]  {Number} Factor in range [0..1] indicating how much the
         * {{#crossLink &quot;Lookat/eye:property&quot;}}Camera&#x27;s eye{{/crossLink}} position will
         * swing away from its {{#crossLink &quot;Lookat/eye:property&quot;}}look{{/crossLink}} position as it flies to the target.
         * @param [params.component] {Number|String|Component} ID or instance of a component to fly to. Defaults to the entire {{#crossLink &quot;Scene&quot;}}{{/crossLink}}.
         * @param [params.aabb] {*}  World-space axis-aligned bounding box (AABB) target to fly to.
         * @param [params.eye] {Float32Array} Position to fly the eye position to.
         * @param [params.look] {Float32Array} Position to fly the look position to.
         * @param [params.up] {Float32Array} Position to fly the up vector to.
         * @param [params.fit=true] {Boolean} Whether to fit the target to the view volume. Overrides {{#crossLink &quot;CameraFlightAnimation/fit:property&quot;}}{{/crossLink}}.
         * @param [params.fitFOV] {Number} How much of field-of-view, in degrees, that a target {{#crossLink &quot;Entity&quot;}}{{/crossLink}} or its AABB should
         * fill the canvas on arrival. Overrides {{#crossLink &quot;CameraFlightAnimation/fitFOV:property&quot;}}{{/crossLink}}.
         * @param [params.duration] {Number} Flight duration in seconds.  Overrides {{#crossLink &quot;CameraFlightAnimation/duration:property&quot;}}{{/crossLink}}.
         * @param [params.orthoScale] {Number} TODO: document this
         * @param [callback] {Function} Callback fired on arrival
         * @param [scope] {Object} Optional scope for callback
         */
        flyTo: (function () {

            var tempVec3 = math.vec3();

            return function (params, callback, scope) {

                params = params || this.scene;

                if (this._flying) {
                    this.stop();
                }

                this._flying = false;

                this._callback = callback;
                this._callbackScope = scope;

                var camera = this.scene.camera;

                this._eye1[0] = camera.eye[0];
                this._eye1[1] = camera.eye[1];
                this._eye1[2] = camera.eye[2];

                this._look1[0] = camera.look[0];
                this._look1[1] = camera.look[1];
                this._look1[2] = camera.look[2];

                this._up1[0] = camera.up[0];
                this._up1[1] = camera.up[1];
                this._up1[2] = camera.up[2];

                this._orthoScale1 = camera.ortho.scale;
                this._orthoScale2 = params.orthoScale || this._orthoScale1;

                var aabb;
                var eye;
                var look;
                var up;
                var componentId;

                if (params.aabb) {
                    aabb = params.aabb;

                } else if (params.length === 6) {
                    aabb = params;

                } else if ((params.eye &amp;&amp; params.look) || params.up) {
                    eye = params.eye;
                    look = params.look;
                    up = params.up;

                } else if (params.eye) {
                    eye = params.eye;

                } else if (params.look) {
                    look = params.look;

                } else {

                    // Argument must be an instance or ID of a Component (subtype)

                    var component = params;

                    if (xeogl._isNumeric(component) || xeogl._isString(component)) {

                        componentId = component;

                        component = this.scene.components[componentId];

                        if (!component) {
                            this.error(&quot;Component not found: &quot; + xeogl._inQuotes(componentId));
                            if (callback) {
                                if (scope) {
                                    callback.call(scope);
                                } else {
                                    callback();
                                }
                            }
                            return;
                        }
                    }

                    aabb = component.aabb || this.scene.aabb;
                }

                var offset = params.offset;

                if (aabb) {

                    if (aabb[3] &lt; aabb[0] || aabb[4] &lt; aabb[1] || aabb[5] &lt; aabb[2]) {

                        // Don&#x27;t fly to an inverted boundary
                        return;
                    }

                    if (aabb[3] === aabb[0] &amp;&amp; aabb[4] === aabb[1] &amp;&amp; aabb[5] === aabb[2]) {

                        // Don&#x27;t fly to an empty boundary
                        return;
                    }


                    // Show boundary

                    if (params.showAABB !== false) {
                        this._aabbHelper.geometry.targetAABB = aabb;
                        this._aabbHelper.visible = true;
                    }

                    var aabbCenter = math.getAABB3Center(aabb);

                    this._look2 = params.look || aabbCenter;

                    if (offset) {
                        this._look2[0] += offset[0];
                        this._look2[1] += offset[1];
                        this._look2[2] += offset[2];
                    }

                    var eyeLookVec = math.subVec3(this._eye1, this._look1, tempVec3);
                    var eyeLookVecNorm = math.normalizeVec3(eyeLookVec);
                    var diag = (params.look &amp;&amp; false) ? math.getAABB3DiagPoint(aabb, params.look) : math.getAABB3Diag(aabb);
                    var fitFOV = params.fitFOV || this._fitFOV;
                    var sca = Math.abs(diag / Math.tan(fitFOV * xeogl.math.DEGTORAD));

                    this._orthoScale2 = diag * 1.1;

                    this._eye2[0] = this._look2[0] + (eyeLookVecNorm[0] * sca);
                    this._eye2[1] = this._look2[1] + (eyeLookVecNorm[1] * sca);
                    this._eye2[2] = this._look2[2] + (eyeLookVecNorm[2] * sca);

                    this._up2[0] = this._up1[0];
                    this._up2[1] = this._up1[1];
                    this._up2[2] = this._up1[2];

                    this._flyEyeLookUp = false;

                } else if (eye || look || up) {

                    this._flyEyeLookUp = !!eye &amp;&amp; !!look &amp;&amp; !!up;
                    this._flyingEye = !!eye &amp;&amp; !look;
                    this._flyingLook = !!look &amp;&amp; !eye;

                    if (look) {
                        this._look2[0] = look[0];
                        this._look2[1] = look[1];
                        this._look2[2] = look[2];
                    }

                    if (eye) {
                        this._eye2[0] = eye[0];
                        this._eye2[1] = eye[1];
                        this._eye2[2] = eye[2];
                    }

                    if (up) {
                        this._up2[0] = up[0];
                        this._up2[1] = up[1];
                        this._up2[2] = up[2];
                    }
                }

                this.fire(&quot;started&quot;, params, true);

                this._time1 = Date.now();
                this._time2 = this._time1 + (params.duration ? params.duration * 1000 : this._duration);

                this._flying = true; // False as soon as we stop

                xeogl.scheduleTask(this._update, this);
            };
        })(),

        /**
         * Jumps the {{#crossLink &quot;Camera&quot;}}{{/crossLink}}&#x27;s {{#crossLink &quot;Camera&quot;}}{{/crossLink}} to the given target.
         *
         *  * When the target is a boundary, this CameraFlightAnimation will position the {{#crossLink &quot;Camera&quot;}}{{/crossLink}}
         *  at where the target fills most of the canvas.
         *  * When the target is an explicit {{#crossLink &quot;Camera&quot;}}{{/crossLink}} position, given as &#x60;&#x60;&#x60;&#x60;eye&#x60;&#x60;&#x60;&#x60;, &#x60;&#x60;&#x60;&#x60;look&#x60;&#x60;&#x60;&#x60; and &#x60;&#x60;&#x60;&#x60;up&#x60;&#x60;&#x60;&#x60;
         *  vectors, then this CameraFlightAnimation will jump the {{#crossLink &quot;Camera&quot;}}{{/crossLink}} to that target.
         *
         * @method flyTo
         * @param params  {*|Component} Either a parameters object or a {{#crossLink &quot;Component&quot;}}{{/crossLink}} subtype that has a World-space AABB.
         * @param[params.arc=0]  {Number} Factor in range [0..1] indicating how much the
         * {{#crossLink &quot;Camera/eye:property&quot;}}Camera&#x27;s eye{{/crossLink}} position will
         * swing away from its {{#crossLink &quot;Camera/eye:property&quot;}}look{{/crossLink}} position as it flies to the target.
         * @param [params.component] {Number|String|Component} ID or instance of a component to fly to.
         * @param [params.aabb] {*}  World-space axis-aligned bounding box (AABB) target to fly to.
         * @param [params.eye] {Float32Array} Position to fly the eye position to.
         * @param [params.look] {Float32Array} Position to fly the look position to.
         * @param [params.up] {Float32Array} Position to fly the up vector to.
         * @param [params.fitFOV] {Number} How much of field-of-view, in degrees, that a target {{#crossLink &quot;Entity&quot;}}{{/crossLink}} or its AABB should
         * fill the canvas on arrival. Overrides {{#crossLink &quot;CameraFlightAnimation/fitFOV:property&quot;}}{{/crossLink}}.
         * @param [params.fit] {Boolean} Whether to fit the target to the view volume. Overrides {{#crossLink &quot;CameraFlightAnimation/fit:property&quot;}}{{/crossLink}}.
         */
        jumpTo: function (params) {
            var self = this;
            //           xeogl.scheduleTask(function () {  // Ensures that required asynch boundaries are built first
            self._jumpTo(params);
            //         });
        },

        _jumpTo: (function () {

            var newEye = math.vec3();
            var newLook = math.vec3();
            var newUp = math.vec3();
            var newLookEyeVec = math.vec3();
            var tempVec3e = math.vec3();

            return function (params) {

                if (this._flying) {
                    this.stop();
                }

                var camera = this.scene.camera;

                var aabb;
                var componentId;

                if (params.aabb) { // Boundary3D

                    aabb = params.aabb;

                } else if (params.length === 6) { // AABB

                    aabb = params;

                } else if (params.eye || params.look || params.up) { // Camera pose

                    newEye = params.eye;
                    newLook = params.look;
                    newUp = params.up;

                } else {

                    // Argument must be an instance or ID of a Component (subtype)

                    var component = params;

                    if (xeogl._isNumeric(component) || xeogl._isString(component)) {

                        componentId = component;

                        component = this.scene.components[componentId];

                        if (!component) {
                            this.error(&quot;Component not found: &quot; + xeogl._inQuotes(componentId));
                            return;
                        }
                    }

                    aabb = component.aabb || this.scene.aabb;
                }

                var offset = params.offset;

                if (aabb) {

                    var diag;

                    if (aabb[3] &lt;= aabb[0] || aabb[4] &lt;= aabb[1] || aabb[5] &lt;= aabb[2]) {

                        // Don&#x27;t fly to an empty boundary
                        return;
                    }

                    diag = math.getAABB3Diag(aabb);
                    math.getAABB3Center(aabb, newLook);

                    if (this._trail) {
                        math.subVec3(camera.look, newLook, newLookEyeVec);
                    } else {
                        math.subVec3(camera.eye, camera.look, newLookEyeVec);
                    }

                    math.normalizeVec3(newLookEyeVec);

                    var dist;

                    var fit = (params.fit !== undefined) ? params.fit : this._fit;
                    if (fit) {
                        dist = Math.abs((diag) / Math.tan((params.fitFOV || this._fitFOV) * xeogl.math.DEGTORAD));

                    } else {
                        dist = math.lenVec3(math.subVec3(camera.eye, camera.look, tempVec3e));
                    }

                    math.mulVec3Scalar(newLookEyeVec, dist);

                    camera.eye = math.addVec3(newLook, newLookEyeVec, newEye);
                    camera.look = newLook;

                } else if (newEye || newLook || newUp) {

                    if (newEye) {
                        camera.eye = newEye;
                    }

                    if (newLook) {
                        camera.look = newLook;
                    }

                    if (newUp) {
                        camera.up = newUp;
                    }
                }
            };
        })(),

        _update: (function () {

            var newLookEyeVec = math.vec3();
            var newEye = math.vec3();
            var newLook = math.vec3();
            var newUp = math.vec3();
            var lookEyeVec = math.vec3();

            return function () {

                if (!this._flying) {
                    return;
                }

                var time = Date.now();

                var t = (time - this._time1) / (this._time2 - this._time1);

                var stopping = (t &gt;= 1);

                if (t &gt; 1) {
                    t = 1;
                }

                t = this.easing ? this._ease(t, 0, 1, 1) : t;

                var camera = this.scene.camera;


                if (this._flyingEye || this._flyingLook) {

                    if (this._flyingEye) {
                        math.subVec3(camera.eye, camera.look, newLookEyeVec);
                        camera.eye = math.lerpVec3(t, 0, 1, this._eye1, this._eye2, newEye);
                        camera.look = math.subVec3(newEye, newLookEyeVec, newLook);

                    } else if (this._flyingLook) {
                        camera.look = math.lerpVec3(t, 0, 1, this._look1, this._look2, newLook);
                    //    camera.eye = math.addVec3(newLook, newLookEyeVec, newEye);
                        camera.up = math.lerpVec3(t, 0, 1, this._up1, this._up2, newUp);
                    }

                } else if (this._flyEyeLookUp) {

                    camera.eye = math.lerpVec3(t, 0, 1, this._eye1, this._eye2, newEye);
                    camera.look = math.lerpVec3(t, 0, 1, this._look1, this._look2, newLook);
                    camera.up = math.lerpVec3(t, 0, 1, this._up1, this._up2, newUp);
                } else {

                    math.lerpVec3(t, 0, 1, this._look1, this._look2, newLook);

                    var dist;

                    if (this._trail) {
                        math.subVec3(newLook, camera.look, newLookEyeVec);

                    } else {
                        math.subVec3(camera.eye, camera.look, newLookEyeVec);
                    }

                    math.normalizeVec3(newLookEyeVec);
                    math.lerpVec3(t, 0, 1, this._eye1, this._eye2, newEye);
                    math.subVec3(newEye, newLook, lookEyeVec);
                    dist = math.lenVec3(lookEyeVec);
                    math.mulVec3Scalar(newLookEyeVec, dist);

                    camera.eye = math.addVec3(newLook, newLookEyeVec, newEye);
                    camera.look = newLook;
                }

                this.scene.camera.ortho.scale = this._orthoScale1 + (t * (this._orthoScale2 - this._orthoScale1));

                if (stopping) {
                    this.stop();
                    return;
                }

                xeogl.scheduleTask(this._update, this); // Keep flying
            };
        })(),

        // Quadratic easing out - decelerating to zero velocity
        // http://gizma.com/easing

        _ease: function (t, b, c, d) {
            t /= d;
            return -c * t * (t - 2) + b;
        },

        /**
         * Stops an earlier flyTo, fires arrival callback.
         * @method stop
         */
        stop: function () {

            if (!this._flying) {
                return;
            }

            this._aabbHelper.visible = false;

            this._flying = false;

            this._time1 = null;
            this._time2 = null;

            var callback = this._callback;

            if (callback) {

                this._callback = null;

                if (this._callbackScope) {
                    callback.call(this._callbackScope);
                } else {
                    callback();
                }
            }

            this.fire(&quot;stopped&quot;, true, true);
        },

        /**
         * Cancels an earlier flyTo without calling the arrival callback.
         * @method cancel
         */
        cancel: function () {

            if (!this._flying) {
                return;
            }

            this._aabbHelper.visible = false;

            this._flying = false;

            this._time1 = null;
            this._time2 = null;

            if (this._callback) {
                this._callback = null;
            }

            this.fire(&quot;canceled&quot;, true, true);
        },

        _props: {

            /**
             * Flight duration, in seconds, when calling {{#crossLink &quot;CameraFlightAnimation/flyTo:method&quot;}}{{/crossLink}}.
             *
             * Stops any flight currently in progress.
             *
             * @property duration
             * @default 0.5
             * @type Number
             */
            duration: {

                set: function (value) {
                    this._duration = value ? (value * 1000.0) : 500;

                    this.stop();
                },

                get: function () {
                    return this._duration / 1000.0;
                }
            },

            /**
             * When true, will ensure that this CameraFlightAnimation is flying to a boundary it will always adjust the distance between the
             * {{#crossLink &quot;CameraFlightAnimation/camera:property&quot;}}camera{{/crossLink}}&#x27;s {{#crossLink &quot;Lookat/eye:property&quot;}}eye{{/crossLink}}
             * and {{#crossLink &quot;Lookat/look:property&quot;}}{{/crossLink}}
             * so as to ensure that the target boundary is always filling the view volume.
             *
             * When false, the eye will remain at its current distance from the look position.
             *
             * @property fit
             * @type Boolean
             * @default true
             */
            fit: {

                set: function (value) {
                    this._fit = value !== false;
                },

                get: function () {
                    return this._fit;
                }
            },


            /**
             * How much of the perspective field-of-view, in degrees, that a target {{#crossLink &quot;Entity&quot;}}{{/crossLink}} or its AABB should
             * fill the canvas when calling {{#crossLink &quot;CameraFlightAnimation/flyTo:method&quot;}}{{/crossLink}} or {{#crossLink &quot;CameraFlightAnimation/jumpTo:method&quot;}}{{/crossLink}}.
             *
             * @property fitFOV
             * @default 45
             * @type Number
             */
            fitFOV: {

                set: function (value) {
                    this._fitFOV = value || 45;
                },

                get: function () {
                    return this._fitFOV;
                }
            },

            /**
             * When true, will cause this CameraFlightAnimation to point the {{#crossLink &quot;CameraFlightAnimation/camera:property&quot;}}{{/crossLink}}
             * in the direction that it is travelling.
             *
             * @property trail
             * @type Boolean
             * @default false
             */
            trail: {

                set: function (value) {
                    this._trail = !!value;
                },

                get: function () {
                    return this._trail;
                }
            }
        },

        _destroy: function () {
            this.stop();
        }
    });

})();

    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
